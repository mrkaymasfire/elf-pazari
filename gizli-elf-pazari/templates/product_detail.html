<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ product.name }} - Elf Pazarı</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=MedievalSharp&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .product-detail-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
            background: rgba(15, 30, 15, 0.98);
            border-radius: 25px;
            border: 2px solid rgba(212, 175, 55, 0.4);
            margin-top: 40px;
            position: relative;
            z-index: 2;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.4);
        }
        
        .product-detail-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
            margin-bottom: 40px;
        }
        
        .product-detail-image-container {
            background: rgba(30, 50, 30, 0.9);
            border-radius: 20px;
            padding: 30px;
            min-height: 400px;
            border: 3px solid rgba(212, 175, 55, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }
        
        .product-detail-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            max-height: 350px;
            transition: transform 0.5s ease;
        }
        
        .product-detail-image:hover {
            transform: scale(1.05);
        }
        
        .image-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 71, 87, 0.9);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            z-index: 2;
        }
        
        .product-detail-info h1 {
            color: #ffde7d;
            font-size: 2.8rem;
            margin-bottom: 20px;
            line-height: 1.3;
        }
        
        .product-price-container {
            margin: 20px 0;
            padding: 20px;
            background: rgba(20, 40, 20, 0.6);
            border-radius: 15px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .original-price {
            color: #b8d8be;
            text-decoration: line-through;
            font-size: 1.5rem;
            margin-right: 15px;
        }
        
        .current-price {
            color: #d4af37;
            font-size: 2.5rem;
            font-weight: bold;
        }
        
        .discount-badge {
            display: inline-block;
            background: linear-gradient(45deg, #4CAF50, #8BC34A);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: bold;
            margin-left: 15px;
            font-size: 1.2rem;
        }
        
        .currency {
            font-size: 1.8rem;
            color: #ffde7d;
            margin-left: 5px;
        }
        
        .product-features {
            margin: 30px 0;
        }
        
        .feature-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            color: #b8d8be;
            font-size: 1.1rem;
        }
        
        .feature-item i {
            color: #ffde7d;
            width: 25px;
        }
        
        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 30px 0;
        }
        
        .quantity-btn {
            width: 45px;
            height: 45px;
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid rgba(212, 175, 55, 0.4);
            color: #ffde7d;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .quantity-btn:hover {
            background: rgba(212, 175, 55, 0.3);
            transform: scale(1.1);
        }
        
        .quantity-display {
            padding: 10px 25px;
            background: rgba(30, 50, 30, 0.8);
            border-radius: 10px;
            min-width: 80px;
            text-align: center;
            color: #ffde7d;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .action-buttons {
            display: flex;
            gap: 20px;
            margin-top: 40px;
        }
        
        .btn-large {
            flex: 1;
            padding: 20px;
            text-align: center;
            font-size: 1.2rem;
            text-decoration: none;
            border-radius: 15px;
            font-family: 'MedievalSharp', cursive;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-weight: bold;
        }
        
        .cart-add-large {
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid rgba(212, 175, 55, 0.4);
            color: #ffde7d;
        }
        
        .cart-add-large:hover {
            background: rgba(212, 175, 55, 0.2);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(212, 175, 55, 0.2);
        }
        
        .buy-now-large {
            background: linear-gradient(to bottom, #2a6b3a, #1a5b2a);
            border: 2px solid #1a5b2a;
            color: white;
        }
        
        .buy-now-large:hover {
            background: linear-gradient(to bottom, #3a7b4a, #2a6b2a);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(42, 107, 58, 0.3);
        }
        
        .related-products {
            margin-top: 60px;
        }
        
        .related-products h2 {
            color: #ffde7d;
            margin-bottom: 30px;
            text-align: center;
            font-size: 2.5rem;
        }
        
        .forest-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .tree-side {
            position: absolute;
            bottom: 0;
            width: 200px;
            height: 100%;
        }
        
        .tree-left {
            left: 0;
            background: linear-gradient(to right, rgba(26, 54, 20, 0.8), transparent);
        }
        
        .tree-right {
            right: 0;
            background: linear-gradient(to left, rgba(26, 54, 20, 0.8), transparent);
        }
        
        .product-meta {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            color: #b8d8be;
            flex-wrap: wrap;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(30, 50, 30, 0.6);
            padding: 8px 15px;
            border-radius: 10px;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        .meta-item i {
            color: #ffde7d;
        }
        
        .stock-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .in-stock {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }
        
        .out-stock {
            background: rgba(255, 107, 129, 0.2);
            color: #ff6b81;
            border: 1px solid rgba(255, 107, 129, 0.3);
        }
        
        .rating-stars {
            color: #ffde7d;
            font-size: 1.2rem;
            margin-left: 5px;
        }
        
        .product-description-long {
            color: #b8d8be;
            line-height: 1.7;
            font-size: 1.1rem;
            margin: 25px 0;
        }
        
        .product-specs {
            background: rgba(20, 40, 20, 0.6);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }
        
        .specs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .spec-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .spec-label {
            color: #b8d8be;
        }
        
        .spec-value {
            color: #ffde7d;
            font-weight: bold;
        }
        
        @media (max-width: 992px) {
            .product-detail-grid {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
        
        @media (max-width: 768px) {
            .product-detail-container {
                padding: 20px;
                margin-top: 20px;
            }
            
            .product-detail-info h1 {
                font-size: 2.2rem;
            }
            
            .current-price {
                font-size: 2rem;
            }
            
            .product-meta {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body class="shop-background">
    <div class="forest-overlay">
        <div class="tree-side tree-left"></div>
        <div class="tree-side tree-right"></div>
    </div>
    
    <div class="product-detail-container">
        <div class="product-detail-grid">
            <!-- ÜRÜN RESMİ -->
            <div class="product-detail-image-container">
                {% if product.featured %}
                <div class="image-badge">
                    <i class="fas fa-crown"></i> ÖNE ÇIKAN
                </div>
                {% endif %}
                
                <img src="/static/images/{{ product.image }}" alt="{{ product.name }}" class="product-detail-image">
            </div>
            
            <!-- ÜRÜN BİLGİLERİ -->
            <div class="product-detail-info">
                <h1>{{ product.name }}</h1>
                
                <div class="product-meta">
                    <div class="meta-item">
                        <i class="fas fa-tag"></i>
                        <span>{{ product.category }}</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-star"></i>
                        <span>{{ product.rating }}/5</span>
                        <div class="rating-stars">
                            {% for i in range(5) %}
                                {% if i < product.rating|int %}
                                    ★
                                {% else %}
                                    ☆
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                    <div class="meta-item stock-status {% if product.in_stock %}in-stock{% else %}out-stock{% endif %}">
                        <i class="fas {% if product.in_stock %}fa-check-circle{% else %}fa-times-circle{% endif %}"></i>
                        <span>{{ "Stokta Var" if product.in_stock else "Tükendi" }}</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-calendar"></i>
                        <span>{{ product.created_at }}</span>
                    </div>
                </div>
                
                <div class="product-price-container">
                    {% if product.discount > 0 %}
                    <div>
                        <span class="original-price">{{ "%.2f"|format(product.price) }} ₺</span>
                        <span class="current-price">
                            {{ "%.2f"|format(discounted_price) }}<span class="currency"> ₺</span>
                        </span>
                        <span class="discount-badge">-{{ product.discount }}%</span>
                    </div>
                    <div style="color: #4CAF50; margin-top: 10px; font-size: 1.1rem;">
                        <i class="fas fa-piggy-bank"></i> {{ "%.2f"|format(product.price - discounted_price) }} ₺ tasarruf edin!
                    </div>
                    {% else %}
                    <div>
                        <span class="current-price">
                            {{ "%.2f"|format(product.price) }}<span class="currency"> ₺</span>
                        </span>
                    </div>
                    {% endif %}
                </div>
                
                <p class="product-description-long">
                    {{ product.description }}
                </p>
                
                <div class="product-features">
                    <div class="feature-item">
                        <i class="fas fa-gift"></i>
                        <span>Özel Hediye Paketi</span>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-truck"></i>
                        <span>Ücretsiz Kargo</span>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-shield-alt"></i>
                        <span>1000 Yıl Garanti</span>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-leaf"></i>
                        <span>Doğal Malzeme</span>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-award"></i>
                        <span>El Yapımı</span>
                    </div>
                </div>
                
                <div class="product-specs">
                    <h3 style="color: #ffde7d; margin-bottom: 20px;">Teknik Özellikler</h3>
                    <div class="specs-grid">
                        <div class="spec-item">
                            <span class="spec-label">Kategori:</span>
                            <span class="spec-value">{{ product.category }}</span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Stok Kodu:</span>
                            <span class="spec-value">ELF-{{ "%04d"|format(product.id) }}</span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Garanti:</span>
                            <span class="spec-value">1000 Yıl</span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Üretim:</span>
                            <span class="spec-value">El Yapımı</span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Malzeme:</span>
                            <span class="spec-value">Doğal</span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Menşei:</span>
                            <span class="spec-value">Elf Atölyeleri</span>
                        </div>
                    </div>
                </div>
                
                <!-- MİKTAR SEÇİMİ -->
                <div class="quantity-selector">
                    <span style="color: #b8d8be; font-size: 1.2rem;">Miktar:</span>
                    <button class="quantity-btn" onclick="decreaseQuantity()">-</button>
                    <div class="quantity-display" id="quantity">1</div>
                    <button class="quantity-btn" onclick="increaseQuantity()">+</button>
                </div>
                
                <!-- AKSİYON BUTONLARI -->
                <div class="action-buttons">
                    <a href="#" class="btn-large cart-add-large" onclick="addToCart()" {% if not product.in_stock %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                        <i class="fas fa-shopping-cart"></i> Sepete Ekle
                    </a>
                    <a href="/checkout" class="btn-large buy-now-large" onclick="buyNow()" {% if not product.in_stock %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                        <i class="fas fa-bolt"></i> Hemen Al
                    </a>
                </div>
            </div>
        </div>
        
        <!-- DETAYLI AÇIKLAMA -->
        <div style="margin-top: 50px; padding: 30px; background: rgba(20, 40, 20, 0.6); border-radius: 15px;">
            <h3 style="color: #ffde7d; margin-bottom: 20px; font-size: 2rem;">
                <i class="fas fa-book"></i> Ürün Hikayesi
            </h3>
            <p style="color: #b8d8be; line-height: 1.7; font-size: 1.1rem;">
                Bu özel Noel ürünü, Kuzey Ormanları'ndaki gizli elf atölyelerinde geleneksel yöntemlerle üretilmiştir. 
                Her bir parça, ustaların yıllar süren deneyimiyle şekillenmiş, özel formüllerle güçlendirilmiştir. 
                Noel ruhunu yansıtan bu koleksiyon parçası, hem günlük kullanım hem de özel günler için ideal bir seçimdir.
                <br><br>
                <strong>Elf Geleneği:</strong> Her ürünün üzerinde, üreten elf zanaatkarın imzası bulunur.
                <br>
                <strong>Kalite Garantisi:</strong> Elf Pazarı 1000 yıllık kalite garantisi verir.
                <br>
                <strong>Çevre Dostu:</strong> %100 doğal ve geri dönüştürülebilir malzemeler kullanılmıştır.
                <br>
                <strong>Özel Paketleme:</strong> Her ürün özel hediye paketinde gönderilir.
            </p>
        </div>
        
        <!-- İLGİLİ ÜRÜNLER -->
        {% if similar_products %}
        <div class="related-products">
            <h2>Benzer Noel Ürünleri</h2>
            <div class="products-grid" style="grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));">
                {% for similar in similar_products %}
                <div class="product-card">
                    {% if similar.featured %}
                    <div class="product-badge featured-badge">
                        <i class="fas fa-crown"></i> Öne Çıkan
                    </div>
                    {% endif %}
                    
                    {% if similar.discount > 0 %}
                    <div class="discount-badge">
                        -{{ similar.discount }}%
                    </div>
                    {% endif %}
                    
                    <div class="product-image-container">
                        <img src="/static/images/{{ similar.image }}" alt="{{ similar.name }}" class="product-image">
                    </div>
                    <div class="product-info">
                        <h3>{{ similar.name }}</h3>
                        <div style="margin: 10px 0;">
                            {% if similar.discount > 0 %}
                            <span class="original-price">{{ "%.2f"|format(similar.price) }} ₺</span>
                            <span class="discounted-price">
                                {{ "%.2f"|format(similar.price * (1 - similar.discount/100)) }} ₺
                            </span>
                            {% else %}
                            <div class="product-price">{{ "%.2f"|format(similar.price) }} ₺</div>
                            {% endif %}
                        </div>
                        <div class="product-actions">
                            <a href="/product/{{ similar.id }}" class="view-btn">
                                <i class="fas fa-eye"></i> İncele
                            </a>
                            <a href="/add_to_cart/{{ similar.id }}" class="cart-add-btn">
                                <i class="fas fa-shopping-cart"></i> Sepete
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
    
    <!-- NAVİGASYON BUTONLARI -->
    <div style="text-align: center; margin: 40px auto; max-width: 1200px;">
        <a href="/magic_shop" class="action-button">
            <i class="fas fa-arrow-left"></i> Tüm Ürünlere Dön
        </a>
        <a href="/cart" class="action-button" style="margin-left: 20px;">
            <i class="fas fa-shopping-cart"></i> Sepete Git
        </a>
        <a href="/" class="action-button" style="margin-left: 20px;">
            <i class="fas fa-home"></i> Ana Sayfa
        </a>
    </div>

    <script>
        let quantity = 1;
        
        function decreaseQuantity() {
            if (quantity > 1) {
                quantity--;
                document.getElementById('quantity').textContent = quantity;
            }
        }
        
        function increaseQuantity() {
            if (quantity < 99) {
                quantity++;
                document.getElementById('quantity').textContent = quantity;
            }
        }
        
        function addToCart() {
            const productId = {{ product.id }};
            
            for (let i = 0; i < quantity; i++) {
                fetch(`/add_to_cart/${productId}`);
            }
            
            showNotification('Ürün sepete eklendi!');
            setTimeout(() => {
                window.location.href = '/cart';
            }, 1500);
        }
        
        function buyNow() {
            addToCart();
            setTimeout(() => {
                window.location.href = '/checkout';
            }, 1000);
        }
        
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(20, 40, 20, 0.95);
                color: #ffde7d;
                padding: 15px 25px;
                border-radius: 15px;
                border: 2px solid rgba(212, 175, 55, 0.5);
                z-index: 1000;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                animation: slideIn 0.3s ease;
                display: flex;
                align-items: center;
                gap: 10px;
            `;
            notification.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // CSS animasyonlarını ekle
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // Ürün görseline zoom efekti
        const productImage = document.querySelector('.product-detail-image');
        const imageContainer = document.querySelector('.product-detail-image-container');
        
        imageContainer.addEventListener('mousemove', (e) => {
            const { left, top, width, height } = imageContainer.getBoundingClientRect();
            const x = (e.clientX - left) / width * 100;
            const y = (e.clientY - top) / height * 100;
            
            productImage.style.transformOrigin = `${x}% ${y}%`;
            productImage.style.transform = 'scale(1.1)';
        });
        
        imageContainer.addEventListener('mouseleave', () => {
            productImage.style.transform = 'scale(1)';
        });
    </script>
</body>
</html>